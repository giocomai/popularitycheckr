<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>An introduction to popularitycheckr • popularitycheckr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="An introduction to popularitycheckr">
<meta property="og:description" content="popularitycheckr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">popularitycheckr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/popularitycheckr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="popularitycheckr_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>An introduction to popularitycheckr</h1>
            
      
      
      <div class="hidden name"><code>popularitycheckr.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw">popularitycheckr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"tidyverse"</span>)
</pre></div>
<p>First things first: to get data, we first need data.</p>
<div id="get-the-data-from-google-analytics" class="section level1">
<h1 class="hasAnchor">
<a href="#get-the-data-from-google-analytics" class="anchor"></a>Get the data from Google Analytics</h1>
<p>Let’s get them from Google Analytics. In order to access data, we need to authenticate and then identify the id for the specific website we want to analyse. If you accept to have an authentication token stored locally, you’ll need to this step only once. Check your account list with <code><a href="https://code.markedmondson.me/googleAnalyticsR//reference/ga_account_list.html">ga_account_list()</a></code> and find the <code>viewId</code> for the one you want to analyse.</p>
<div class="sourceCode" id="cb2"><pre class="downlit">

<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st"><a href="http://code.markedmondson.me/googleAnalyticsR">"googleAnalyticsR"</a></span>)

<span class="fu"><a href="https://code.markedmondson.me/googleAnalyticsR//reference/ga_auth.html">ga_auth</a></span>()

<span class="fu"><a href="https://code.markedmondson.me/googleAnalyticsR//reference/ga_account_list.html">ga_account_list</a></span>() <span class="op">%&gt;%</span> 
  <span class="fu">select</span>(<span class="kw">websiteUrl</span>, <span class="kw">viewId</span>)
</pre></div>
<p>In order to store the viewId as an environment variable, removing the need to specify it at every function call you can use <code><a href="../reference/pc_set_ga_id.html">pc_set_ga_id()</a></code>. This needs to be set once per session.</p>
<div class="sourceCode" id="cb3"><pre class="downlit">
<span class="fu"><a href="../reference/pc_set_ga_id.html">pc_set_ga_id</a></span>(<span class="fl">1234567</span>)
</pre></div>
<p>Let’s get all backlinks to our website in the last month. Only essential data will be retained: <code>source</code>, <code>fullReferrer</code> (i.e. the full link to the page from where the visitor arrived), <code>landingPagePath</code> (i.e. the full URL, without domain, where the user arrived on our website), and <code>sessions</code> (i.e. the number of sessions) generated in this way in the given time period.</p>
<div class="sourceCode" id="cb4"><pre class="downlit">
<span class="kw">backlinks</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pc_get_backlinks.html">pc_get_backlinks</a></span>(date_range = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.Date</a></span>()<span class="op">-</span><span class="fl">32</span>,
                                             <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.Date</a></span>()<span class="op">-</span><span class="fl">1</span>))
</pre></div>
<p>These backlinks can be stored for reference and direct consultations on Google Drive, with:</p>
<div class="sourceCode" id="cb5"><pre class="downlit">
<span class="fu"><a href="../reference/pc_upload_backlinks.html">pc_upload_backlinks</a></span>(<span class="kw">backlinks</span>)
</pre></div>
<p>Only new data will be uploaded, so data on the current date should not be included. The uploading can be piped, e.g.:</p>
<div class="sourceCode" id="cb6"><pre class="downlit">
<span class="fu"><a href="../reference/pc_get_backlinks.html">pc_get_backlinks</a></span>() <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/pc_upload_backlinks.html">pc_upload_backlinks</a></span>()
</pre></div>
<div id="process-backlinks" class="section level2">
<h2 class="hasAnchor">
<a href="#process-backlinks" class="anchor"></a>Process backlinks</h2>
<p>The following command creates the spreadsheet where manual input is given about sources to be whitelisted or blacklisted (this is in draft stage, does not currently process further).</p>
<div class="sourceCode" id="cb7"><pre class="downlit">
<span class="fu"><a href="../reference/pc_process_backlinks.html">pc_process_backlinks</a></span>(<span class="fu"><a href="../reference/pc_get_backlinks.html">pc_get_backlinks</a></span>())
</pre></div>
<p>Then it’s time to load the relevant spreadsheet, and manually input which sources or specific referrals should be whitelistes or blacklisted. To open in your browser the relevant spreadsheet:</p>
<div class="sourceCode" id="cb8"><pre class="downlit">
<span class="kw">googledrive</span>::<span class="fu"><a href="https://googledrive.tidyverse.org/reference/drive_browse.html">drive_browse</a></span>(file = <span class="fu"><a href="../reference/pc_find_dribble.html">pc_find_dribble</a></span>(type = <span class="st">"inputs"</span>, content = <span class="st">"process"</span>))
</pre></div>
<p>Put an <code>x</code> (or whatever characther you like) in the relevant column to categorise sources/referrers.</p>
<p>To process the inputs, run the command:</p>
<div class="sourceCode" id="cb9"><pre class="downlit">
<span class="fu"><a href="../reference/pc_process_lists.html">pc_process_lists</a></span>()
</pre></div>
<p>This removes the rows from the “process” spreadsheet and moves it to its own, and the removes <em>all</em> of the lines which use that given source (or each line mentioning that specific referrer).</p>
<p>The objective here is similar to that of “inbox zero”, i.e. getting all lines out of the <code>process</code> sheet and have them categorised in some way.</p>
<p>Once this is done, you can then move whitelisted backlinks to a separate spreadsheet for further processing.</p>
<div class="sourceCode" id="cb10"><pre class="downlit">
<span class="fu"><a href="../reference/pc_process_move_whitelisted.html">pc_process_move_whitelisted</a></span>(backlinks = <span class="fu"><a href="../reference/pc_get_backlinks.html">pc_get_backlinks</a></span>())
<span class="kw">googledrive</span>::<span class="fu"><a href="https://googledrive.tidyverse.org/reference/drive_browse.html">drive_browse</a></span>(file = <span class="fu"><a href="../reference/pc_find_dribble.html">pc_find_dribble</a></span>(type = <span class="st">"inputs"</span>, content = <span class="st">"combine"</span>))
</pre></div>
</div>
<div id="combine-with-data-extracted-from-the-website" class="section level2">
<h2 class="hasAnchor">
<a href="#combine-with-data-extracted-from-the-website" class="anchor"></a>Combine with data extracted from the website</h2>
<p>Use named functions to place the selected string in the relevant column.</p>
<div class="sourceCode" id="cb11"><pre class="downlit">
<span class="fu"><a href="../reference/pc_combine.html">pc_combine</a></span>(
  title = <span class="fu">function</span>(<span class="kw">url</span>) {
    <span class="fu"><a href="../reference/pc_extract_from_web.html">pc_extract_from_web</a></span>(url = <span class="kw">url</span>,
                        container = <span class="st">"title"</span>) <span class="op">%&gt;%</span>
      <span class="kw">stringr</span>::<span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html">str_remove</a></span>(pattern = <span class="st">" /.*"</span>)
  },
    language = <span class="fu">function</span>(<span class="kw">url</span>) {
    <span class="kw">xml2</span>::<span class="fu"><a href="http://xml2.r-lib.org/reference/read_xml.html">read_html</a></span>(x = <span class="kw">url</span>) <span class="op">%&gt;%</span> 
      <span class="kw">rvest</span>::<span class="fu"><a href="https://rvest.tidyverse.org/reference/html_nodes.html">html_nodes</a></span>(xpath = <span class="st">"//meta[@name='Content-language']"</span>) <span class="op">%&gt;%</span> 
      <span class="kw">rvest</span>::<span class="fu"><a href="https://rvest.tidyverse.org/reference/html_text.html">html_attr</a></span>(<span class="st">'content'</span>)
  },
  date = <span class="fu">function</span>(<span class="kw">url</span>) {
    <span class="fu"><a href="../reference/pc_extract_from_web.html">pc_extract_from_web</a></span>(url = <span class="kw">url</span>,
                        container = <span class="st">"div"</span>,
                        container_class = <span class="st">"date"</span>) <span class="op">%&gt;%</span>
      <span class="kw">stringr</span>::<span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html">str_remove</a></span>(pattern = <span class="st">"[[:alpha:]]+[[:punct:]]?[[:space:]]?"</span>) <span class="op">%&gt;%</span>
      <span class="kw">lubridate</span>::<span class="fu"><a href="http://lubridate.tidyverse.org/reference/ymd.html">dmy</a></span>(quiet = <span class="fl">TRUE</span>,
                     locale = <span class="kw">xml2</span>::<span class="fu"><a href="http://xml2.r-lib.org/reference/read_xml.html">read_html</a></span>(x = <span class="kw">url</span>) <span class="op">%&gt;%</span> 
                       <span class="kw">rvest</span>::<span class="fu"><a href="https://rvest.tidyverse.org/reference/html_nodes.html">html_nodes</a></span>(xpath = <span class="st">"//meta[@name='Content-language']"</span>) <span class="op">%&gt;%</span> 
                       <span class="kw">rvest</span>::<span class="fu"><a href="https://rvest.tidyverse.org/reference/html_text.html">html_attr</a></span>(<span class="st">'content'</span>) <span class="op">%&gt;%</span> <span class="kw">stringr</span>::<span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace</a></span>(<span class="st">"-"</span>, <span class="st">"_"</span>)) <span class="op">%&gt;%</span> 
      <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>()
  }
)
<span class="kw">googledrive</span>::<span class="fu"><a href="https://googledrive.tidyverse.org/reference/drive_browse.html">drive_browse</a></span>(file = <span class="fu"><a href="../reference/pc_find_dribble.html">pc_find_dribble</a></span>(type = <span class="st">"inputs"</span>, content = <span class="st">"combine"</span>))
</pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Giorgio Comai.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
